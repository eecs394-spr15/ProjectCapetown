<html>
<script type="text/javascript" src = "https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script type="text/javascript" src = "https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

  <div ng-controller="IndexController">

    <div class="list">
    <label class="item item-input item-select">
        <img src="/imags/NUwildcats.png" onclick="location.reload()" width="50px"; height="40px"> <!-- Add the refresh function when click the WildCat-->
        <div style="margin-left:20px; color:#9933ff; font-weight:bold; font-size:120%">
          NU Bulletin Board
        </div>
      <select>
        <option>Research</option>
        <option selected>Music</option>
      </select>
    </label>
  </div>
  </div>

    <div id = "events"></div>

  <script type = "foo/bar" id = "eventTemplate">

    <div class="list" ng-controller="IndexController">
          <a class="item item-thumbnail-left" href="#">
          <img src = "<%=posterIcon._url%>" height = "80" width="80" style="top: 40px"></img>
          <h2><%=study%></h2>
          <p><%="$" + compensation%>, <%=duration%></p>
          <p><%=location%></p>
          <p><%="Start date: " +startdate_str%></p>
          <p><%="End date: " + enddate_str%></p>
          <p>
          <i class = "icon super-heart-broken" style="font-size: 25px; float: right; padding-right: 10px" onclick="addDislikeNum('<%=testId%>')"></i>
          <i class = "icon super-heart" style="font-size: 25px; float: right; padding-right: 20px" onclick="addLikeNum('<%=testId%>')"></i>
          <i class = "icon super-email" style="font-size: 25px; float: right; padding-right: 20px" onclick="sendEmail()"></i>
          <%=likeNum + " Like"%> <%=dislikeNum + " Dislike"%>
          </p>
        </a>

    </div>

  </script>





  <script type="text/javascript">
    Parse.initialize("susDpNWLgi3QqeprNxBKeQ7uIJK0srYlde52neVb", "OMWpK5Oa17fiNcDyTkqvbKz2HHL6szH4jPYXlhz0");
     var template = $("#eventTemplate").html();
     us_template = _.template(template);
     var createEvent = function(a) {
         $("#events").append(us_template(a));
      }
     var TestObject = Parse.Object.extend("TestObject");
     var testObject = new TestObject();
     testObject.save({foo: "Frank124"}).then(function(object) {
     });

     var EventObject = Parse.Object.extend("event");
     var query = new Parse.Query(EventObject);

     query.find({
        success: function(results) {

         for (var i = 0; i<results.length; i++)  //The length of data should be mutable
         {

           var object = results[i].attributes;
           //test ID retrieval
           object.testId = results[i].id;

           //testForId = object.testId;

           createEvent(object);
         }

       document.getElementById("1").innerHTML = "success";
     },
       error: function(object, error) {

        document.getElementById("1").innerHTML = "error";
     }
    });


    function addLikeNum(id) {
      //alert("testForLike");
      var EventForVote = Parse.Object.extend("event");
      var query = new Parse.Query(EventForVote);
      query.get(id,{
        success: function(results) {
          results.increment('likeNum');
          results.save();
          alert(results.get('likeNum'));
          //alert(id);
          location.reload();
     },
       error: function(object, error) {
         alert("Error");
     }
    });
    };

    function addDislikeNum(id) {
      //alert("testForDislike");
      var EventForVote = Parse.Object.extend("event");
      var query = new Parse.Query(EventForVote);
      query.get(id,{
        success: function(results) {
          results.increment('dislikeNum');
          results.save();
          alert(results.get('dislikeNum'));
          //alert(id);
          location.reload();
     },
       error: function(object, error) {
         alert("Error");
     }
    });
    };



   </script>


   <script>
   function sendEmail()
   {
     var EMAIL_ADDRESS = "";
     window.open("mailto:" + EMAIL_ADDRESS);
   };


   </script>








<style>
    .container
    {
        width:100%;
    }
    #M-button
    {
        width:50%;
        display: inline !important;
    }
    #R-button
    {
        width:50%;
        display: inline !important;
    }
</style>
</html>
